--Tabla Cliente
CREATE TABLE CLIENTE(
	ID_CLIENTE serial CONSTRAINT PK_ID_CLIENTE PRIMARY KEY,
	NOMBRE_CLIENTE varchar(30) NOT NULL,
	APELLIDO_CLIENTE varchar(30) NOT NULL,
	DIRECCION_CLIENTE varchar(200) NOT NULL,
	TELEFONO_CLIENTE varchar(30) NOT NULL,
	CELULAR_CLIENTE varchar(30) NOT NULL,
	NACIONALIDAD_CLIENTE varchar(30) NOT NULL,
	CEDULA_CLIENTE varchar(30) NOT NULL,
	FECHA_NACIMIENTO date DEFAULT CURRENT_DATE,
	GENERO varchar(30)
);
--TABLA MASCOTAS
CREATE TABLE MASCOTAS(
	ID_PLANTILLA_REGISTRO serial CONSTRAINT PK_ID_PLANTILLA_REGISTRO PRIMARY KEY,
	ID_CLIENTE integer NOT NULL,
	FECHA_NACIMIENTO date DEFAULT CURRENT_DATE,
	EDAD integer NOT NULL,
	RAZA varchar(10),
	ORIGEN_RAZA varchar(30)

);
--FACTURA
CREATE TABLE FACTURA(
	ID_FACTURA serial CONSTRAINT PK_ID_FACTURA PRIMARY KEY,
	ID_PLANTILLA_REGISTRO integer NOT NULL,
	FECHA_EMISION date DEFAULT CURRENT_DATE,
	FORMA_PAGO varchar(30),
	ESTADO varchar(15),
	PRECIO_ESTANCIA real NOT NULL,
	TOTAL real
);


/* Tabla: SERVICIOS_FACTURA                                   */

CREATE TABLE SERVICIOS_FACTURA(
	ID_SERVICIOS_FACTURA serial CONSTRAINT PK_ID_SERVICIOS_FACTURA PRIMARY KEY,
	ID_FACTURA integer NOT NULL,
	ID_SERVICIO integer NOT NULL,
	ID_PERSONAL integer NOT NULL,
	FECHA_SERVICIO date DEFAULT CURRENT_DATE,
	TOTAL real NOT NULL
);


/* Tabla: SERVICIOS                                           */

CREATE TABLE SERVICIOS(
	ID_SERVICIO serial CONSTRAINT PK_ID_SERVICIO PRIMARY KEY,
	DESCRIPCION varchar(30) NOT NULL,
	PRECIO real NOT NULL
);

/* Tabla: PERSONAL                                            */
CREATE TABLE PERSONAL(
	ID_PERSONAL serial CONSTRAINT PK_ID_PERSONAL PRIMARY KEY,
	ID_TIPO_PERSONAL integer NOT NULL,
	NOMBRE_PERSONAL varchar(30) NOT NULL,
	APELLIDO_PERSONAL varchar(30) NOT NULL,
	TELEFONO varchar(10)
);

/* Tabla: TIPO_PERSONAL                                       */
CREATE TABLE TIPO_PERSONAL(
	ID_TIPO_PERSONAL serial CONSTRAINT PK_ID_TIPO_PERSONAL PRIMARY KEY,
	DESCRIPCION varchar(30) NOT NULL
);

/* Tabla: TERAPIAS                                            */

CREATE TABLE TERAPIAS(
	ID_TERAPIA serial CONSTRAINT PK_ID_TERAPIA PRIMARY KEY,
	ID_PLANTILLA_REGISTRO integer NOT NULL,
	ID_PERSONAL integer NOT NULL,
	FECHA_TERAPIA date DEFAULT CURRENT_DATE
);

/* Tabla: REVISIONES_MEDICA                                   */

CREATE TABLE REVISIONES_MEDICAS(
	ID_REVISION_MEDICA serial CONSTRAINT PK_ID_REVISION_MEDICA PRIMARY KEY,
	ID_PLANTILLA_REGISTRO integer NOT NULL,
	ID_PERSONAL integer NOT NULL,
	FECHA_REVISION date DEFAULT CURRENT_DATE
);

/* Tabla: CERTIFICADOS                                        */

CREATE TABLE CERTIFICADOS(
	ID_CERTIFICADO serial CONSTRAINT PK_ID_CERTIFICADO PRIMARY KEY,
	DESCRIPCION varchar(30) NOT NULL,
	VALOR real NOT NULL
);

/* Tabla: CERTIFICADOS_MASCOTAS                             */

CREATE TABLE CERTIFICADOS_MASCOTAS(
	ID_CERTIFICADOS_MASCOTAS serial CONSTRAINT PK_ID_CERTIFICADOS_MASCOTAS PRIMARY KEY,
	ID_PLANTILLA_REGISTRO integer NOT NULL
);


/* Tabla: EMISION_CERTIFICADOS                                */

CREATE TABLE EMISION_CERTIFICADOS(
	ID_EMISION_CERTIFICADOS serial CONSTRAINT PK_ID_EMISION_CERTIFICADOS PRIMARY KEY,
	ID_CERTIFICADOS_MASCOTAS integer NOT NULL,
	ID_CERTIFICADO integer NOT NULL,
	FECHA_EMISION date DEFAULT CURRENT_DATE
);

CREATE TABLE EVENTOS(
	ID_EVENTO serial CONSTRAINT PK_ID_EVENTO PRIMARY KEY,
	ID_TIPO_EVENTO integer NOT NULL,
	FECHA_EVENTO date DEFAULT CURRENT_DATE
);

                                   

CREATE TABLE TIPO_EVENTO(
	ID_TIPO_EVENTO serial CONSTRAINT PK_ID_TIPO_EVENTO PRIMARY KEY,
	DESCRIPCION varchar(30) NOT NULL
);

CREATE TABLE ASISTENCIA_EVENTOS(
	ID_ASISTENCIA_EVENTO serial CONSTRAINT PK_ID_ASISTENCIA_EVENTO PRIMARY KEY,
	ID_EVENTO integer NOT NULL,
	ID_PLANTILLA_REGISTRO integer NOT NULL
);

ALTER TABLE EVENTOS 
ADD CONSTRAINT FK_ID_TIPO_EVENTO
FOREIGN KEY (ID_TIPO_EVENTO)  
REFERENCES TIPO_EVENTO(ID_TIPO_EVENTO)
ON DELETE RESTRICT ON UPDATE CASCADE;
--relación ASISTENCIA_EVENTOS EVENTOS
ALTER TABLE ASISTENCIA_EVENTOS 
ADD CONSTRAINT FK_ID_EVENTO
FOREIGN KEY (ID_EVENTO)  
REFERENCES EVENTOS(ID_EVENTO)
ON DELETE RESTRICT ON UPDATE CASCADE;
--relación ASISTENCIA_EVENTOS EVENTOS
ALTER TABLE ASISTENCIA_EVENTOS 
ADD CONSTRAINT FK_ID_PLANTILLA_REGISTRO
FOREIGN KEY (ID_PLANTILLA_REGISTRO)  
REFERENCES MASCOTAS(ID_PLANTILLA_REGISTRO)
ON DELETE RESTRICT ON UPDATE CASCADE;


--relación PLANTILLA_REGISTRO CLIENTE
ALTER TABLE MASCOTAS 
ADD CONSTRAINT FK_ID_CLIENTE
FOREIGN KEY (ID_CLIENTE)  
REFERENCES CLIENTE(ID_CLIENTE)
ON DELETE RESTRICT ON UPDATE CASCADE;


--relación FACTURA PLANTILLA_REGISTRO
ALTER TABLE FACTURA 
ADD CONSTRAINT FK_ID_PLANTILLA_REGISTRO
FOREIGN KEY (ID_PLANTILLA_REGISTRO)  
REFERENCES MASCOTAS(ID_PLANTILLA_REGISTRO)
ON DELETE RESTRICT ON UPDATE CASCADE;


--relación SERVICIOS_FACTURA FACTURA
ALTER TABLE SERVICIOS_FACTURA 
ADD CONSTRAINT FK_ID_FACTURA
FOREIGN KEY (ID_FACTURA)  
REFERENCES FACTURA(ID_FACTURA)
ON DELETE RESTRICT ON UPDATE CASCADE;


--relación SERVICIOS_FACTURA SERVICIOS
ALTER TABLE SERVICIOS_FACTURA 
ADD CONSTRAINT FK_ID_SERVICIO
FOREIGN KEY (ID_SERVICIO)  
REFERENCES SERVICIOS(ID_SERVICIO)
ON DELETE RESTRICT ON UPDATE CASCADE;

--relación SERVICIOS_FACTURA PERSONAL
ALTER TABLE SERVICIOS_FACTURA 
ADD CONSTRAINT FK_ID_PERSONAL
FOREIGN KEY (ID_PERSONAL)  
REFERENCES PERSONAL(ID_PERSONAL)
ON DELETE RESTRICT ON UPDATE CASCADE;

--relación PERSONAL TIPO_PERSONAL
ALTER TABLE PERSONAL 
ADD CONSTRAINT FK_ID_TIPO_PERSONAL
FOREIGN KEY (ID_TIPO_PERSONAL)  
REFERENCES TIPO_PERSONAL(ID_TIPO_PERSONAL)
ON DELETE RESTRICT ON UPDATE CASCADE;



--relación TERAPIAS PLANTILLA_REGISTRO
ALTER TABLE TERAPIAS 
ADD CONSTRAINT FK_ID_PLANTILLA_REGISTRO
FOREIGN KEY (ID_PLANTILLA_REGISTRO)  
REFERENCES MASCOTAS(ID_PLANTILLA_REGISTRO)
ON DELETE RESTRICT ON UPDATE CASCADE;

--relación TERAPIAS PERSONAL
ALTER TABLE TERAPIAS 
ADD CONSTRAINT FK_ID_PERSONAL
FOREIGN KEY (ID_PERSONAL)  
REFERENCES PERSONAL(ID_PERSONAL)
ON DELETE RESTRICT ON UPDATE CASCADE;


--relación REVISIONES_MEDICAS MASCOTAS
ALTER TABLE REVISIONES_MEDICAS 
ADD CONSTRAINT FK_ID_PLANTILLA_REGISTRO
FOREIGN KEY (ID_PLANTILLA_REGISTRO)  
REFERENCES MASCOTAS(ID_PLANTILLA_REGISTRO)

ON DELETE RESTRICT ON UPDATE CASCADE;
--relación REVISIONES_MEDICAS PERSONAL
ALTER TABLE REVISIONES_MEDICAS 
ADD CONSTRAINT FK_ID_PERSONAL
FOREIGN KEY (ID_PERSONAL)  
REFERENCES PERSONAL(ID_PERSONAL)
ON DELETE RESTRICT ON UPDATE CASCADE;

--relación CERTIFICADOS_MASCOTAS MASCOTAS
ALTER TABLE CERTIFICADOS_MASCOTAS
ADD CONSTRAINT FK_ID_PLANTILLA_REGISTRO
FOREIGN KEY (ID_PLANTILLA_REGISTRO)  
REFERENCES MASCOTAS(ID_PLANTILLA_REGISTRO)
ON DELETE RESTRICT ON UPDATE CASCADE;

--relación EMISION_CERTIFICADOS CERTIFICADOS_MASCOTAS
ALTER TABLE EMISION_CERTIFICADOS 
ADD CONSTRAINT FK_ID_CERTIFICADOS_MASCOTAS
FOREIGN KEY (ID_CERTIFICADOS_MASCOTAS)  
REFERENCES CERTIFICADOS_MASCOTAS(ID_CERTIFICADOS_MASCOTAS)
ON DELETE RESTRICT ON UPDATE CASCADE;

--relación EMISION_CERTIFICADOS CERTIFICADOS
ALTER TABLE EMISION_CERTIFICADOS 
ADD CONSTRAINT FK_ID_CERTIFICADO
FOREIGN KEY (ID_CERTIFICADO)  
REFERENCES CERTIFICADOS(ID_CERTIFICADO)
ON DELETE RESTRICT ON UPDATE CASCADE;


INSERT INTO CLIENTE (NOMBRE_CLIENTE, APELLIDO_CLIENTE ,DIRECCION_CLIENTE, TELEFONO_CLIENTE, CELULAR_CLIENTE, NACIONALIDAD_CLIENTE,CEDULA_CLIENTE, FECHA_NACIMIENTO ,GENERO) VALUES ('Alexander','Intriago','Los Gladiolos','6220444','995366883','peruana','74489385','1999-03-19','Masculino');
INSERT INTO CLIENTE (NOMBRE_CLIENTE, APELLIDO_CLIENTE ,DIRECCION_CLIENTE, TELEFONO_CLIENTE, CELULAR_CLIENTE, NACIONALIDAD_CLIENTE,CEDULA_CLIENTE, FECHA_NACIMIENTO ,GENERO) VALUES ('Carla','Gonzales','Los Gladiolos 324','6220443','983847651','peruana','74489384','1989-02-19','Femenino');
INSERT INTO CLIENTE (NOMBRE_CLIENTE, APELLIDO_CLIENTE ,DIRECCION_CLIENTE, TELEFONO_CLIENTE, CELULAR_CLIENTE, NACIONALIDAD_CLIENTE,CEDULA_CLIENTE, FECHA_NACIMIENTO ,GENERO) VALUES ('Pedro','Jimenez','Los Gladiolos 102','6220442','995312383','peruana','74489383','1998-03-21','Masculino');
INSERT INTO CLIENTE (NOMBRE_CLIENTE, APELLIDO_CLIENTE ,DIRECCION_CLIENTE, TELEFONO_CLIENTE, CELULAR_CLIENTE, NACIONALIDAD_CLIENTE,CEDULA_CLIENTE, FECHA_NACIMIENTO ,GENERO) VALUES ('Camila','Conde','Los Gladiolos 145','6220441','995361283','peruana','74489382','1995-05-19','Femenino');
INSERT INTO CLIENTE (NOMBRE_CLIENTE, APELLIDO_CLIENTE ,DIRECCION_CLIENTE, TELEFONO_CLIENTE, CELULAR_CLIENTE, NACIONALIDAD_CLIENTE,CEDULA_CLIENTE, FECHA_NACIMIENTO ,GENERO) VALUES ('Junior','Enciso','Los Gladiolos 125','6220440','995385183','peruana','74489312','1958-03-22','Masculino');
INSERT INTO CLIENTE (NOMBRE_CLIENTE, APELLIDO_CLIENTE ,DIRECCION_CLIENTE, TELEFONO_CLIENTE, CELULAR_CLIENTE, NACIONALIDAD_CLIENTE,CEDULA_CLIENTE, FECHA_NACIMIENTO ,GENERO) VALUES ('Sarela','Camacho','Los Gladiolos 256','6220449','995369683','peruana','74489123','1963-07-19','Femenino');
INSERT INTO CLIENTE (NOMBRE_CLIENTE, APELLIDO_CLIENTE ,DIRECCION_CLIENTE, TELEFONO_CLIENTE, CELULAR_CLIENTE, NACIONALIDAD_CLIENTE,CEDULA_CLIENTE, FECHA_NACIMIENTO ,GENERO) VALUES ('Daniel','Paredes','Los Pereginos','6220412','995365483','peruana','744893156','1986-03-1','Masculino');
INSERT INTO CLIENTE (NOMBRE_CLIENTE, APELLIDO_CLIENTE ,DIRECCION_CLIENTE, TELEFONO_CLIENTE, CELULAR_CLIENTE, NACIONALIDAD_CLIENTE,CEDULA_CLIENTE, FECHA_NACIMIENTO ,GENERO) VALUES ('Juana','Bracamonte','Los Gardiana','6220158','995366965','peruana','74489125','1983-03-19','Femenino');
INSERT INTO CLIENTE (NOMBRE_CLIENTE, APELLIDO_CLIENTE ,DIRECCION_CLIENTE, TELEFONO_CLIENTE, CELULAR_CLIENTE, NACIONALIDAD_CLIENTE,CEDULA_CLIENTE, FECHA_NACIMIENTO ,GENERO) VALUES ('Danilo','Linares','Los Olivos','6220124','995366123','peruana','74489321','1987-03-19','Masculino');
INSERT INTO CLIENTE (NOMBRE_CLIENTE, APELLIDO_CLIENTE ,DIRECCION_CLIENTE, TELEFONO_CLIENTE, CELULAR_CLIENTE, NACIONALIDAD_CLIENTE,CEDULA_CLIENTE, FECHA_NACIMIENTO ,GENERO) VALUES ('Johana','Porras','Los Periones','6220414','995361597','peruana','74489125','1963-03-19','Femenino');



INSERT INTO MASCOTAS (ID_CLIENTE, FECHA_NACIMIENTO, EDAD, RAZA, ORIGEN_RAZA) VALUES (1,'2021-03-14',1,'Poodle','Ninguna');

INSERT INTO MASCOTAS (ID_CLIENTE, FECHA_NACIMIENTO, EDAD, RAZA, ORIGEN_RAZA) VALUES (2,'2020-03-12',2,'Chihuahua','Mexico');

INSERT INTO MASCOTAS (ID_CLIENTE, FECHA_NACIMIENTO, EDAD, RAZA, ORIGEN_RAZA) VALUES (6,'2018-03-10',4,'Chitzu','Ninguna');

INSERT INTO MASCOTAS (ID_CLIENTE, FECHA_NACIMIENTO, EDAD, RAZA, ORIGEN_RAZA) VALUES (3,'2021-08-14',1,'Labrador','Ninguno');

INSERT INTO MASCOTAS (ID_CLIENTE, FECHA_NACIMIENTO, EDAD, RAZA, ORIGEN_RAZA) VALUES (4,'2020-02-05',2,'Dalmata','Ninguna');

INSERT INTO MASCOTAS (ID_CLIENTE, FECHA_NACIMIENTO, EDAD, RAZA, ORIGEN_RAZA) VALUES (5,'2018-05-10',4,'Chitzu','Ninguna');






INSERT INTO SERVICIOS (DESCRIPCION, PRECIO) VALUES('Lavado','20.50');
INSERT INTO SERVICIOS (DESCRIPCION, PRECIO) VALUES('Tratamiento Piel','500.00');
INSERT INTO SERVICIOS (DESCRIPCION, PRECIO) VALUES('Uñas','50.00');
INSERT INTO SERVICIOS (DESCRIPCION, PRECIO) VALUES('Uñas','10.50');
INSERT INTO SERVICIOS (DESCRIPCION, PRECIO) VALUES('Estimulacion','180.00');
INSERT INTO SERVICIOS (DESCRIPCION, PRECIO) VALUES('Tratamiento Piel','510.00');



INSERT INTO TIPO_PERSONAL(DESCRIPCION) VALUES('Bañadores');
INSERT INTO TIPO_PERSONAL(DESCRIPCION) VALUES('Masajista');
INSERT INTO TIPO_PERSONAL(DESCRIPCION) VALUES('Doctor');
INSERT INTO TIPO_PERSONAL(DESCRIPCION) VALUES('Enfermero');
INSERT INTO TIPO_PERSONAL(DESCRIPCION) VALUES('Masajista');
INSERT INTO TIPO_PERSONAL(DESCRIPCION) VALUES('Bañadores');
INSERT INTO TIPO_PERSONAL(DESCRIPCION) VALUES('Masajista');



INSERT INTO PERSONAL (ID_TIPO_PERSONAL, NOMBRE_PERSONAL, APELLIDO_PERSONAL, TELEFONO) VALUES(1,'Juan Carlos','Perez Cedeño','0995672517');
INSERT INTO PERSONAL (ID_TIPO_PERSONAL, NOMBRE_PERSONAL, APELLIDO_PERSONAL, TELEFONO) VALUES(1,'Paulo Javier','Perez Cedeño','0995882113');
INSERT INTO PERSONAL (ID_TIPO_PERSONAL, NOMBRE_PERSONAL, APELLIDO_PERSONAL, TELEFONO) VALUES(2,'Jose Marcos','Hurtado Macias','0995672511');
INSERT INTO PERSONAL (ID_TIPO_PERSONAL, NOMBRE_PERSONAL, APELLIDO_PERSONAL, TELEFONO) VALUES(2,'Maria Belen','Cuero Sanchez','0995672512');
INSERT INTO PERSONAL (ID_TIPO_PERSONAL, NOMBRE_PERSONAL, APELLIDO_PERSONAL, TELEFONO) VALUES(3,'Roberto Humberto','Vera Rodriguez','0995672513');
INSERT INTO PERSONAL (ID_TIPO_PERSONAL, NOMBRE_PERSONAL, APELLIDO_PERSONAL, TELEFONO) VALUES(3,'Bruno Petroleo','Pascuaza Loor','0995672514');
INSERT INTO PERSONAL (ID_TIPO_PERSONAL, NOMBRE_PERSONAL, APELLIDO_PERSONAL, TELEFONO) VALUES(4,'Diego Felix','Suarez Cedeño','0995672515');
INSERT INTO PERSONAL (ID_TIPO_PERSONAL, NOMBRE_PERSONAL, APELLIDO_PERSONAL, TELEFONO) VALUES(4,'Gilmar Eduardo','Napa Caicedo','0995672516');
INSERT INTO PERSONAL (ID_TIPO_PERSONAL, NOMBRE_PERSONAL, APELLIDO_PERSONAL, TELEFONO) VALUES(5,'Alexander Bryan','Dominguez Paz','0995672518');
INSERT INTO PERSONAL (ID_TIPO_PERSONAL, NOMBRE_PERSONAL, APELLIDO_PERSONAL, TELEFONO) VALUES(5,'Robert Jose','Arboleda Pascuaza','0995672519');
INSERT INTO PERSONAL (ID_TIPO_PERSONAL, NOMBRE_PERSONAL, APELLIDO_PERSONAL, TELEFONO) VALUES(6,'Byron Xavier','Castillo Cedeño','0995672510');
INSERT INTO PERSONAL (ID_TIPO_PERSONAL, NOMBRE_PERSONAL, APELLIDO_PERSONAL, TELEFONO) VALUES(6,'Jhoanner Stalin','Chávez Quintero','0995672524');
INSERT INTO PERSONAL (ID_TIPO_PERSONAL, NOMBRE_PERSONAL, APELLIDO_PERSONAL, TELEFONO) VALUES(7,'Eduar Ayrton','Preciado García','0995672300');
INSERT INTO PERSONAL (ID_TIPO_PERSONAL, NOMBRE_PERSONAL, APELLIDO_PERSONAL, TELEFONO) VALUES(7,'Kevin José','Rodríguez Cortéz','0995672533');





INSERT INTO FACTURA (ID_PLANTILLA_REGISTRO, FECHA_EMISION, FORMA_PAGO, ESTADO, PRECIO_ESTANCIA, TOTAL) VALUES (1,'2022-03-14','Efectivo','Pagada','100.00','112.50');
INSERT INTO SERVICIOS_FACTURA (ID_FACTURA, ID_SERVICIO, ID_PERSONAL, FECHA_SERVICIO, TOTAL) VALUES(1,1,11,'2022-03-19','2.50');
INSERT INTO SERVICIOS_FACTURA (ID_FACTURA, ID_SERVICIO, ID_PERSONAL, FECHA_SERVICIO, TOTAL) VALUES(1,2,13,'2022-03-26','5.00');
INSERT INTO SERVICIOS_FACTURA (ID_FACTURA, ID_SERVICIO, ID_PERSONAL, FECHA_SERVICIO, TOTAL) VALUES(1,3,9,'2022-03-28','5.00');



INSERT INTO FACTURA (ID_PLANTILLA_REGISTRO, FECHA_EMISION, FORMA_PAGO, ESTADO, PRECIO_ESTANCIA, TOTAL) VALUES (2,'2022-11-12','Efectivo','Pendiente','100.00','105.00');
INSERT INTO SERVICIOS_FACTURA (ID_FACTURA, ID_SERVICIO, ID_PERSONAL, FECHA_SERVICIO, TOTAL) VALUES(2,2,13,'2022-11-12','5.00');



INSERT INTO FACTURA (ID_PLANTILLA_REGISTRO, FECHA_EMISION, FORMA_PAGO, ESTADO, PRECIO_ESTANCIA, TOTAL) VALUES (3,'2022-11-12','Efectivo','Pendiente','100.00','102.50');
INSERT INTO SERVICIOS_FACTURA (ID_FACTURA, ID_SERVICIO, ID_PERSONAL, FECHA_SERVICIO, TOTAL) VALUES(3,1,11,'2022-11-12','2.50');



INSERT INTO FACTURA (ID_PLANTILLA_REGISTRO, FECHA_EMISION, FORMA_PAGO, ESTADO, PRECIO_ESTANCIA, TOTAL) VALUES (4,'2018-01-01','Efectivo','Pagada','100.00','112.50');
INSERT INTO SERVICIOS_FACTURA (ID_FACTURA, ID_SERVICIO, ID_PERSONAL, FECHA_SERVICIO, TOTAL) VALUES(4,1,11,'2018-01-05','2.50');
INSERT INTO SERVICIOS_FACTURA (ID_FACTURA, ID_SERVICIO, ID_PERSONAL, FECHA_SERVICIO, TOTAL) VALUES(4,2,13,'2018-01-10','5.00');
INSERT INTO SERVICIOS_FACTURA (ID_FACTURA, ID_SERVICIO, ID_PERSONAL, FECHA_SERVICIO, TOTAL) VALUES(4,3,9,'2018-01-15','5.00');



INSERT INTO FACTURA (ID_PLANTILLA_REGISTRO, FECHA_EMISION, FORMA_PAGO, ESTADO, PRECIO_ESTANCIA, TOTAL) VALUES (5,'2015-07-20','Efectivo','Pagada','100.00','112.50');
INSERT INTO SERVICIOS_FACTURA (ID_FACTURA, ID_SERVICIO, ID_PERSONAL, FECHA_SERVICIO, TOTAL) VALUES(5,1,11,'2015-07-21','2.50');
INSERT INTO SERVICIOS_FACTURA (ID_FACTURA, ID_SERVICIO, ID_PERSONAL, FECHA_SERVICIO, TOTAL) VALUES(5,2,13,'2015-07-25','5.00');
INSERT INTO SERVICIOS_FACTURA (ID_FACTURA, ID_SERVICIO, ID_PERSONAL, FECHA_SERVICIO, TOTAL) VALUES(5,3,9,'2015-07-28','5.00');




INSERT INTO TERAPIAS (ID_PLANTILLA_REGISTRO, ID_PERSONAL, FECHA_TERAPIA) VALUES(1,3,'2022-03-21');
INSERT INTO TERAPIAS (ID_PLANTILLA_REGISTRO, ID_PERSONAL, FECHA_TERAPIA) VALUES(1,4,'2022-04-21');
INSERT INTO TERAPIAS (ID_PLANTILLA_REGISTRO, ID_PERSONAL, FECHA_TERAPIA) VALUES(1,4,'2022-05-21');
INSERT INTO TERAPIAS (ID_PLANTILLA_REGISTRO, ID_PERSONAL, FECHA_TERAPIA) VALUES(2,4,'2022-11-13');
INSERT INTO TERAPIAS (ID_PLANTILLA_REGISTRO, ID_PERSONAL, FECHA_TERAPIA) VALUES(3,3,'2022-11-14');
INSERT INTO TERAPIAS (ID_PLANTILLA_REGISTRO, ID_PERSONAL, FECHA_TERAPIA) VALUES(4,3,'2015-07-25');
INSERT INTO TERAPIAS (ID_PLANTILLA_REGISTRO, ID_PERSONAL, FECHA_TERAPIA) VALUES(5,3,'2018-02-15');

INSERT INTO REVISIONES_MEDICAS (ID_PLANTILLA_REGISTRO, ID_PERSONAL, FECHA_REVISION) VALUES(1,3,'2022-03-15');
INSERT INTO REVISIONES_MEDICAS (ID_PLANTILLA_REGISTRO, ID_PERSONAL, FECHA_REVISION) VALUES(1,4,'2022-04-15');
INSERT INTO REVISIONES_MEDICAS (ID_PLANTILLA_REGISTRO, ID_PERSONAL, FECHA_REVISION) VALUES(1,4,'2022-05-15');
INSERT INTO REVISIONES_MEDICAS (ID_PLANTILLA_REGISTRO, ID_PERSONAL, FECHA_REVISION) VALUES(2,4,'2022-11-12');
INSERT INTO REVISIONES_MEDICAS (ID_PLANTILLA_REGISTRO, ID_PERSONAL, FECHA_REVISION) VALUES(3,3,'2022-11-12');
INSERT INTO REVISIONES_MEDICAS (ID_PLANTILLA_REGISTRO, ID_PERSONAL, FECHA_REVISION) VALUES(4,3,'2015-07-21');
INSERT INTO REVISIONES_MEDICAS (ID_PLANTILLA_REGISTRO, ID_PERSONAL, FECHA_REVISION) VALUES(5,3,'2018-01-02');



INSERT INTO TIPO_EVENTO (DESCRIPCION) VALUES('Abandonada');
INSERT INTO TIPO_EVENTO (DESCRIPCION) VALUES('En Adopcion');
INSERT INTO TIPO_EVENTO (DESCRIPCION) VALUES('Ventas');
INSERT INTO TIPO_EVENTO (DESCRIPCION) VALUES('Donadas');


INSERT INTO EVENTOS (ID_TIPO_EVENTO, FECHA_EVENTO) VALUES(4,'2018-01-01');
INSERT INTO EVENTOS (ID_TIPO_EVENTO, FECHA_EVENTO) VALUES(3,'2022-03-17');
INSERT INTO EVENTOS (ID_TIPO_EVENTO, FECHA_EVENTO) VALUES(2,'2022-05-17');
INSERT INTO EVENTOS (ID_TIPO_EVENTO, FECHA_EVENTO) VALUES(1,'2022-11-12');

INSERT INTO ASISTENCIA_EVENTOS (ID_EVENTO, ID_PLANTILLA_REGISTRO) VALUES(2, 2);
INSERT INTO ASISTENCIA_EVENTOS (ID_EVENTO, ID_PLANTILLA_REGISTRO) VALUES(3, 1);


select
	servicios.descripcion as Servicios,
	count (servicios_factura.total) as Cantidad
from servicios_factura
	inner join servicios on servicios_factura.id_servicio = servicios.id_servicio
	where servicios_factura.fecha_servicio between '2022-01-01' and '2022-12-31'
	GROUP BY servicios.descripcion ORDER BY Cantidad desc



select
	COUNT(mascotas) as Mascotas
	from mascotas
	where mascotas.fecha_nacimiento between '2018-01-01' and '2022-12-31'



select
	servicios.descripcion as clientes,
	SUM(servicios_factura.total) as Costos
from servicios_factura
	inner join servicios on servicios_factura.id_servicio = servicios.id_servicio
	where servicios_factura.fecha_servicio between '2022-01-01' and '2022-12-31'
	GROUP BY servicios.descripcion ORDER BY Costos desc



select
	COUNT(EVENTOS) as Abandonadas
	from EVENTOS 
	where EVENTOS.fecha_evento between '2022-01-01' and '2022-12-31'and
	EVENTOS .ID_TIPO_EVENTO=1; 


	
do $$
declare
	registro Record;
	Cursor_Cantidad Cursor for 
	select 
		cliente.genero as Genero,
		COUNT(servicios_factura) as Cantidad
	from servicios_factura
		inner join factura on servicios_factura.id_factura = factura.id_factura
		inner join mascotas on factura.id_plantilla_registro = MASCOTAS.id_plantilla_registro
		inner join cliente on mascotas.id_cliente = cliente.id_cliente
	group by cliente.genero;
begin
Open Cursor_CantidadServiciosPorGenero;
Fetch Cursor_CantidadServiciosPorGenero into registro;
while (found) loop
Raise Notice 'Género: %, Cantidad de servicios: %', registro.genero, registro.Cantidad;
Fetch Cursor_Cantidad into registro;
end loop;
end$$
Language 'plpgsql';


create function atencionesEspecialista(nombre varchar) returns integer as
$$
declare
cantidadAtenciones integer;
begin
cantidadAtenciones:=
(select count(terapias) as Cantidad
from terapias inner join personal on terapias.id_personal = personal.id_personal
where personal.nombre_personal = nombre);
return cantidadAtenciones;
end;
$$
language plpgsql;

select atencionesEspecialista('Jose Marcos') as Cantidad_Atenciones


select 
	cast(extract(year from mascotas.fecha_nacimiento) as INTEGER) as Anio,
	cast(count(mascotas.id_plantilla_registro)as INTEGER ) as Ingresos
from mascotas
group by Anio

